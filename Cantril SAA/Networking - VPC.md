#networking #vpc 

- CIDR
	- method for allocating IP addresses
	- Used in Security Groups rules and AWS networking in general
	- defines an IP address range
	- Has two components
		- Base IP
			- Contained in the range
		- Subnet Mask
			- Defines how many bits can change in IP
			- /0, /24, /32
	- Subnet Mask
		- The lower the subnet number we have more IP addresses in the range
		- /0 allows for all IPs
- Public vs Private IP
	- The IANA established blocks of IPs only used for Public and Private
	- Private IP can only allow certain values
- VPC in AWS
	- VPC = Virtual Private Cloud
	- Can have multiple VPCs in an AWS region (max 5 per region soft limit)
	- Max CIDR per VPC is 5 for each CIDR
		- Min size /28
		- Max size /16
	- VPC is private, only private IPv4 ranges allowed
	- YOUR VPC CIDR SHOULD NOT OVERLAP WITH YOUR OTHER NETWORKS
- VPC - Subnet (IPv4)
	- AWS reserves 5 IP addresses (first 4 & last 1) in each subnet
- Internet Gateway (IGW)
	- Allow resources in a VPC to connect to the internet
	- Scales horizontally, highly available, and redundant
	- Must be created separately from a VPC
	- One VPC can only be attached to one IGW and vice versa
	- Internet gateways on their own do not allow internet access
	- Route tables must also be edited
- Bastion Hosts
	- EC2 Instance in the Public Subnet (Bastion Host)
	- We can use the Bastion Host to SSH into private EC2 instances
	- Is connected to all other private subnets
	- Bastion Host security group must allow access from the internet
		- Access from the public CIDR from your corporation for example
	- Security Group of the EC2 Instances must allow the Security Group of the Bastion Host or the private IP of the Bastion host
- NAT Instance
	- Outdated but still on exam
	- Network Address Translation
	- Allows EC2s in the private subnets to connect to the internet
	- Must be launched in a public subnet
	- Must disable EC2 setting: Source / destination Check
	- Must have Elastic IP attached to it
	- Route tables must be made to route traffic from private subnets to the NAT Instance
- NAT Gateway
	- AWS-managed NAT
	- Pay per hour
	- NATGW created in specific AZ, uses Elastic IP
	- Requires an IGW (Private Subnet => NATGW => IGW)
	- 5 Gbps of bandwidth with automatic scaling up to 100 Gbps
	- No security groups required
- NAT Gateway with High Availability
	- resilient within a single AZ
	- must create multiple NAT Gateways in multiple AZs for fault-tolerance
	- There is no cross-AZ failover needed because if an AZ goes down it doesn't need NAT
- Security Groups & NACLs
	- like a firewall which control traffic and to subnets
	- One NACL per subnet
	- New subnets assigned the default NACL
	- NACL Rules
		- Rules have a number, higher precedence with a lower number
		- First rule match will drive the decision
		- The last rule is an a (*) and denies a request if none of the rules match
		- AWS recommends adding rules by increment 100
	- Newly created NACLs will deny everything
	- NACL are a great way of blocking a specific IP address at the subnet level
- Default NACL
	- Accepts everything inbound/outbound with the subnets it's associated with
	- Do not modify, create custom NACLs
- Ephemeral Ports
	- for two endpoints to establish a connection they must use ports
	- Clients connect to a defined port, and expect a response on an ephemeral port
	- Different Operating Systems use different port ranges
- NACL with Ephemeral Ports
	- 